## 自动化项目工程文件

如何使用该文件？

**准备数据** 两个 xlsx 文件：1.某只基金的净值数据 2. 该基金希望对标的指数数据

- 合理的基金净值数据文件示例如下。说明：①基金净值列的列名需要和基金名称相同，净值开始值可以不是1.00；②最左侧必须是日期列，第二列必须是净值列。③虽然给出了第三列，但是第三列是无效的，在程序执行过程中会被直接忽略。最好只给出前两列数据即可。

| |	九章幻方 |	000905.SH | 
| ---- | ---- | ---- | 
| 2017-01-20 |	1.00 |	6,121.9983| 
|2017-01-26 |	1.00 	|6,223.7061 |
|2017-02-03	|1.00| 	6,207.0921|
|2017-02-10|	1.00 |	6,337.1081|
|2017-02-17|	1.00| 	6,307.1627|
|2017-02-24	|1.00 	|6,476.1655|
|2017-03-03|	1.00| 	6,452.8390|
|2017-03-10|	1.01 |	6,447.9165|
|2017-03-17	|1.02| 	6,483.2463|

- 合理的指数数据文件示例如下。说明：①指数价格走势列名必须是指数名称。②最左侧必须是日期列。③对于非指增基金，后面几列可以包含若干指数数据，这些指数数据都会被绘制在净值走势图中；对于指增基金，只能包含一列指数数据，即该指增基金对标的指数数据。

|	       | 中证1000 | 中证500 |
| ---- | ---- | ---- |
|2022-09-02 | 6776.8268   |  12345 |
|2022-09-09	| 6913.579    |  67891 |
|2022-09-16	| 6481.2442   |  51515 |
|2022-09-23	| 6363.6835   |  17194 |
|2022-09-30	| 6124.8639   |  12548 |
|2022-10-14	| 6406.4573   |  12846 |
|2022-10-21	| 6432.3255   |  18460 |
|2022-10-28	| 6239.9316   |  89131 |
|2022-11-04	| 6709.6446   |  19841 |

**设置参数** 在main.py文件分别设置两个xlsx文件数据的路径，指定是否是指增基金，指定私募管理人名称，下面的代码是一个示例。

```
def main():
    # 净值数据表路径，只会处理前两列数据，后面列的数据会被直接忽略。
    netval_path = "data/净值数据.xlsx" 
    # 指数数据表路径：① 非指增：允许添加多列指数数据；② 指增：只允许添加一列指数数据
    index_path = "data/指数数据.xlsx"
    # 需要在参数中手动指明是否是指增类基金，False表示不是指增基金，True表示指增基金  
    enhanced_fund = True 
    # 私募基金管理人名称
    corp_name = "图灵基金" 
    single_fund_report(netval_path, index_path, enhanced_fund, corp_name)
```

日期设置。Python 中有多种日期格式，为了保证统一处理，在代码中手动输入的日期格式必须是 datetime.date 格式，下面是一个示例。

```
from datetime import date
start_date: date = date(2023, 8, 19) # 注意：日期需要这样按照 年-月-日 来创建
```

**其它功能**

程序是十分灵活的，在编写时预设了很多可对外调用的函数和方法。如果不希望导出WORD，只希望根据净值数据计算一些指标，比如夏普、年化等，可以参考 [interactive_code.ipynb](interactive_code.ipynb)。

**测试程序时的运行环境**
```
- python 3.8.8
- numpy 1.24.4
- pandas 2.0.3
- pywin32 306
```
